%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                      %
%     File: Thesis_Conclusions.tex                                     %
%     Tex Master: Thesis.tex                                           %
%                                                                      %
%     Author: Jo√£o D. Lopes                                            %
%     Last modified :  28 September 2017                               %
%                                                                      %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Conclusions}
\label{chapter:conclusions}

In this thesis we have described a new Coarse Grained Reconfigurable
Array (CGRA) architecture, named Versat, and we have compared it with
some other CGRA architectures. The main difference is that Versat uses
self-generated and partial reconfiguration. These configurations are
generated by an internal controller. The controller also takes care of
data transfers to/from the external memory and simple algorithmic
control. This allows Versat to independently run complex kernels such
as the FFT and K-Means Clustering kernels, whose implementation has
been presented in this thesis.

Versat is a minimal fixed-point CGRA with 4 dual-port embedded
memories, 11 FUs, and a basic 16-instruction controller. Compared with
other CGRAs with larger arrays, Versat requires a more sophisticated
reconfiguration mechanism: the Versat controller can generate partial
configurations and writes them field by field to a fully addressable
configuration register file. The controller is also in charge of data
transfers and basic algorithmic flows. This new architecture has
several novel features: (1) one address generation unit per memory
port, tightly coupled to it; (2) pointer support as values computed in
the data engine can be used as memory addresses; (3) the address
sequences produced by the address generators can be output and used in
the data engine for any other purposes (data generators); (4) the ALUs
support conditional and cumulative functions such as the accumulate
and minimum functions, computed only if a condition is true. Feature
(3) is especially useful for generating synchronization signals for
the functional units in the data engine and feature (4) enables the
execution of loops that contain if statements in their bodies.

Despite its limited compute resources, Versat is extremely flexible to
program. In fact, it can be programmed like a traditional controller,
where the program itself creates and partially reconfigures hardware
datapaths in its data engine. The full mesh topology of the data
engine is easy to deal with by programmers. Versat is capable of
useful acceleration at low clock rates and, given its small size and
parallelism, it can save orders of magnitude in terms of energy. It
can be programmed in two different ways: in assembly language and
using a C/C++ subset. To the best of our knowledge, Versat is the only
CGRA architecture that can be programmed in assembly
language. Assembling programmability provides ultimate control over
all architecture details and is invaluable in software optimization,
debug and system repair. Versat is designed to be a programmable
alternative to dedicated hardware accelerators, eliminating the risk
of design errors. A software driver for host processors to use Versat
has been developed. A host processor only needs a few function calls
to program and run Versat kernels. The run function passes external
memory data pointers and other specific parameters used in the Versat
kernels. There is also a wait function used to check whether the
kernel has finished. The host can run code in parallel with Versat by
placing this code between the Versat run and wait functions.


% ----------------------------------------------------------------------
\section{Achievements}
\label{section:achievements}

The results show that the Versat speedup and energy ratio improve with
the kernel complexity. The kernel complexity depends on the number of
datapaths (configurations) that can be run sequentially using the data
already into the Versat memories. In fact, our results show that
single datapath kernels achieve speedups in the order of $2\times$ and
the gains in terms of energy are considerable, while multiple datapath
kernels can achieve speedups an order of magnitude higher and save
much more energy.

Unlike other CGRAs, which are designed to accelerate a single program
loop, Versat is designed to accelerate a sequence of chained program
loops, where the results produced in one loop are consumed by the next
one. It has been explained that most of the times the next
configuration can be generated while the DMA or the current
configuration on the data engine is running. Because the Versat
controller can generate configurations, these do not need to be stored
in the external memory and then moved into Versat. In general, the
code to generate configurations is much smaller than the
configurations themselves.

Versat has been implemented in FPGA and in ASIC technology. In terms
of silicon area, Versat is comparable to a basic low range CPU.
Results on a VLSI implementation show that Versat is competitive in
terms of silicon area, frequency of operation and power
consumption. Versat is $9.4\times$ smaller than an ARM Cortex A9
processor and can achieve $553MHz$ of clock frequency, while the ARM
core can run at $800MHz$ in the same $40nm$ technology
node. Performance results on running an FFT kernel show that the
Versat core can be $18\times$ faster and $220\times$ more energy
efficient than the embedded processor. Running a K-Means Clustering
algorithm, it is $3.8\times$ faster and consumes $46.3\times$ less
energy. It should be clear from these numbers that GPUs and FPGAs
cannot compete in this arena, and that the presented solution is
useful in applications where cost and energy consumption are crucial.

Note that performance depends on how often such kernels are used in a
complete application. In multimedia algorithms, for instance, between
$40\%$ to $80\%$ of the execution time in a regular CPU can use an
accelerator such as the one described here. This means that important
overall speedups can be expected in practical applications.

This works has given rise to quite a few publications, one book
chapter~\cite{vecparBook16}, and 5 conference
papers~\cite{deSousa16,jcer16,rec17,fpl17,jcer17}, of
which~\cite{rec17} won the best paper award.

% ----------------------------------------------------------------------
\section{Future Work}
\label{section:future}

The work on Versat can be continued in many different fronts. First of
all, many hardware optimizations can be done to improve the area,
power and clock frequency even more. Reducing the configuration memory
and applying clock gating techniques are two examples of what can be
tried.

Floating point units are already being developed, as well as a
Convolutional Neural Network (CNN) kernel for the Versat architecture,
in two other master' thesis. By adding floating point units,
algorithms that require this data type can be run on Versat. Since
Versat can considerably accelerate a 1D-convolution kernel, CNN
kernels that apply convolutions repeatedly with high data reuse are
expected to have excellent performance and energy footprint compared
to a CPU.

The Versat compiler needs to be upgraded and expounded. In fact many
hew hardware features have been added since the compiler has been
released. For example the compiler cannot make use of pointers in
describing datapaths, which are already supported by the hardware. The
same goes for using the address generators as general purpose sequence
generators in datapaths. Moreover the compiler needs to support user
declared variables, freeing the user to explicitly refer to hardware
registers and memories.

Finally, more work on the architecture is needed. Namely, it is
planned to increase the number of processing nodes (all FUs excluding
memories), in order to move from accelerated embedded computing to
high performance embedded computing or even super computing. This
extended architecture has been called Deep Versat.

